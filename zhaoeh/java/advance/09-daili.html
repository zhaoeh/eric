<!doctype html>
<html>
<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width initial-scale=1'>
    <title>带你玩转Java代理设计模式.md</title>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext'
          rel='stylesheet' type='text/css'/>
    <style type='text/css'>html {
        overflow-x: initial !important;
    }

    .CodeMirror {
        height: auto;
    }

    .CodeMirror-scroll {
        overflow-y: hidden;
        overflow-x: auto;
    }

    .CodeMirror-lines {
        padding: 4px 0px;
    }

    .CodeMirror pre {
    }

    .CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {
        background-color: white;
    }

    .CodeMirror-gutters {
        border-right: 1px solid rgb(221, 221, 221);
        background-color: rgb(247, 247, 247);
        white-space: nowrap;
    }

    .CodeMirror-linenumbers {
    }

    .CodeMirror-linenumber {
        padding: 0px 3px 0px 5px;
        text-align: right;
        color: rgb(153, 153, 153);
    }

    .CodeMirror div.CodeMirror-cursor {
        border-left: 1px solid black;
        z-index: 3;
    }

    .CodeMirror div.CodeMirror-secondarycursor {
        border-left: 1px solid silver;
    }

    .CodeMirror.cm-keymap-fat-cursor div.CodeMirror-cursor {
        width: auto;
        border: 0px;
        background: rgb(119, 238, 119);
        z-index: 1;
    }

    .CodeMirror div.CodeMirror-cursor.CodeMirror-overwrite {
    }

    .cm-tab {
        display: inline-block;
    }

    .cm-s-typora-default .cm-header, .cm-s-typora-default .cm-property {
        color: rgb(217, 79, 138);
    }

    .cm-s-typora-default pre.cm-header1:not(.cm-atom) :not(.cm-overlay) {
        font-size: 2rem;
        line-height: 2rem;
    }

    .cm-s-typora-default pre.cm-header2:not(.cm-atom) :not(.cm-overlay) {
        font-size: 1.4rem;
        line-height: 1.4rem;
    }

    .cm-s-typora-default .cm-atom, .cm-s-typora-default .cm-number {
        color: rgb(149, 132, 134);
    }

    .cm-s-typora-default .cm-table-row, .cm-s-typora-default .cm-block-start {
        font-family: monospace;
    }

    .cm-s-typora-default .cm-comment, .cm-s-typora-default .cm-code {
        color: rgb(74, 90, 159);
        font-family: monospace;
    }

    .cm-s-typora-default .cm-tag {
        color: rgb(169, 68, 66);
    }

    .cm-s-typora-default .cm-string {
        color: rgb(126, 134, 169);
    }

    .cm-s-typora-default .cm-link {
        color: rgb(196, 122, 15);
        text-decoration: underline;
    }

    .cm-s-typora-default .cm-variable-2, .cm-s-typora-default .cm-variable-1 {
        color: inherit;
    }

    .cm-s-typora-default .cm-overlay {
        font-family: monospace;
    }

    .CodeMirror.cm-s-typora-default div.CodeMirror-cursor {
        border-left: 3px solid rgb(228, 98, 154);
    }

    .cm-s-typora-default .CodeMirror-activeline-background {
        left: -60px;
        right: -30px;
        background: rgba(204, 204, 204, 0.2);
    }

    .cm-s-typora-default .CodeMirror-gutters {
        border-right: none;
        background-color: inherit;
    }

    .cm-s-typora-default .cm-trailing-space-new-line::after, .cm-startspace::after, .cm-starttab .cm-tab::after {
        content: "•";
        position: absolute;
        left: 0px;
        opacity: 0;
        font-family: LetterGothicStd, monospace;
    }

    .os-windows .cm-startspace::after, .os-windows .cm-starttab .cm-tab::after {
        left: -0.1em;
    }

    .cm-starttab .cm-tab::after {
        content: " ";
    }

    .cm-startspace, .cm-tab, .cm-starttab, .cm-trailing-space-a, .cm-trailing-space-b, .cm-trailing-space-new-line {
        font-family: monospace;
        position: relative;
    }

    .cm-s-typora-default .cm-trailing-space-new-line::after {
        content: "↓";
        opacity: 0.3;
    }

    .cm-s-inner .cm-keyword {
        color: rgb(119, 0, 136);
    }

    .cm-s-inner .cm-atom, .cm-s-inner.cm-atom {
        color: rgb(34, 17, 153);
    }

    .cm-s-inner .cm-number {
        color: rgb(17, 102, 68);
    }

    .cm-s-inner .cm-def {
        color: rgb(0, 0, 255);
    }

    .cm-s-inner .cm-variable {
        color: black;
    }

    .cm-s-inner .cm-variable-2 {
        color: rgb(0, 85, 170);
    }

    .cm-s-inner .cm-variable-3 {
        color: rgb(0, 136, 85);
    }

    .cm-s-inner .cm-property {
        color: black;
    }

    .cm-s-inner .cm-operator {
        color: rgb(152, 26, 26);
    }

    .cm-s-inner .cm-comment, .cm-s-inner.cm-comment {
        color: rgb(170, 85, 0);
    }

    .cm-s-inner .cm-string {
        color: rgb(170, 17, 17);
    }

    .cm-s-inner .cm-string-2 {
        color: rgb(255, 85, 0);
    }

    .cm-s-inner .cm-meta {
        color: rgb(85, 85, 85);
    }

    .cm-s-inner .cm-qualifier {
        color: rgb(85, 85, 85);
    }

    .cm-s-inner .cm-builtin {
        color: rgb(51, 0, 170);
    }

    .cm-s-inner .cm-bracket {
        color: rgb(153, 153, 119);
    }

    .cm-s-inner .cm-tag {
        color: rgb(17, 119, 0);
    }

    .cm-s-inner .cm-attribute {
        color: rgb(0, 0, 204);
    }

    .cm-s-inner .cm-header, .cm-s-inner.cm-header {
        color: blue;
    }

    .cm-s-inner .cm-quote, .cm-s-inner.cm-quote {
        color: rgb(0, 153, 0);
    }

    .cm-s-inner .cm-hr, .cm-s-inner.cm-hr {
        color: rgb(153, 153, 153);
    }

    .cm-s-inner .cm-link, .cm-s-inner.cm-link {
        color: rgb(0, 0, 204);
    }

    .cm-negative {
        color: rgb(221, 68, 68);
    }

    .cm-positive {
        color: rgb(34, 153, 34);
    }

    .cm-header, .cm-strong {
        font-weight: bold;
    }

    .cm-del {
        text-decoration: line-through;
    }

    .cm-em {
        font-style: italic;
    }

    .cm-link {
        text-decoration: underline;
    }

    .cm-error {
        color: rgb(255, 0, 0);
    }

    .cm-invalidchar {
        color: rgb(255, 0, 0);
    }

    .cm-constant {
        color: rgb(38, 139, 210);
    }

    .cm-defined {
        color: rgb(181, 137, 0);
    }

    div.CodeMirror span.CodeMirror-matchingbracket {
        color: rgb(0, 255, 0);
    }

    div.CodeMirror span.CodeMirror-nonmatchingbracket {
        color: rgb(255, 34, 34);
    }

    .cm-s-inner .CodeMirror-activeline-background {
        background: inherit;
    }

    .CodeMirror {
        position: relative;
        overflow: hidden;
    }

    .CodeMirror-scroll {
        margin-bottom: -30px;
        margin-right: -30px;
        padding-bottom: 30px;
        padding-right: 30px;
        height: 100%;
        outline: none;
        position: relative;
        box-sizing: content-box;
    }

    .CodeMirror-sizer {
        position: relative;
    }

    .CodeMirror-vscrollbar, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {
        position: absolute;
        z-index: 6;
        display: none;
    }

    .CodeMirror-vscrollbar {
        right: 0px;
        top: 0px;
        overflow-x: hidden;
        overflow-y: scroll;
    }

    .CodeMirror-hscrollbar {
        bottom: 0px;
        left: 0px;
        overflow-y: hidden;
        overflow-x: scroll;
    }

    .CodeMirror-scrollbar-filler {
        right: 0px;
        bottom: 0px;
    }

    .CodeMirror-gutter-filler {
        left: 0px;
        bottom: 0px;
    }

    .CodeMirror-gutters {
        position: absolute;
        left: 0px;
        top: 0px;
        padding-bottom: 30px;
        z-index: 3;
    }

    .CodeMirror-gutter {
        white-space: normal;
        height: 100%;
        box-sizing: content-box;
        padding-bottom: 30px;
        margin-bottom: -32px;
        display: inline-block;
    }

    .CodeMirror-gutter-wrapper {
        position: absolute;
        z-index: 4;
        background: none !important;
        border: none !important;
    }

    .CodeMirror-gutter-background {
        position: absolute;
        top: 0px;
        bottom: 0px;
        z-index: 4;
    }

    .CodeMirror-gutter-elt {
        position: absolute;
        cursor: default;
        z-index: 4;
    }

    .CodeMirror-lines {
        cursor: text;
    }

    .CodeMirror pre {
        border-radius: 0px;
        border-width: 0px;
        background: transparent;
        font-family: inherit;
        font-size: inherit;
        margin: 0px;
        white-space: pre;
        word-wrap: normal;
        color: inherit;
        z-index: 2;
        position: relative;
        overflow: visible;
    }

    .CodeMirror-wrap pre {
        word-wrap: break-word;
        white-space: pre-wrap;
        word-break: normal;
    }

    .CodeMirror-code pre {
        border-right: 30px solid transparent;
        width: fit-content;
    }

    .CodeMirror-wrap .CodeMirror-code pre {
        border-right: none;
        width: auto;
    }

    .CodeMirror-linebackground {
        position: absolute;
        left: 0px;
        right: 0px;
        top: 0px;
        bottom: 0px;
        z-index: 0;
    }

    .CodeMirror-linewidget {
        position: relative;
        z-index: 2;
        overflow: auto;
    }

    .CodeMirror-widget {
    }

    .CodeMirror-wrap .CodeMirror-scroll {
        overflow-x: hidden;
    }

    .CodeMirror-measure {
        position: absolute;
        width: 100%;
        height: 0px;
        overflow: hidden;
        visibility: hidden;
    }

    .CodeMirror-measure pre {
        position: static;
    }

    .CodeMirror div.CodeMirror-cursor {
        position: absolute;
        visibility: hidden;
        border-right: none;
        width: 0px;
    }

    .CodeMirror div.CodeMirror-cursor {
        visibility: hidden;
    }

    .CodeMirror-focused div.CodeMirror-cursor {
        visibility: inherit;
    }

    .CodeMirror-selected {
        background: rgb(217, 217, 217);
    }

    .CodeMirror-focused .CodeMirror-selected {
        background: rgb(215, 212, 240);
    }

    .cm-searching {
        background: rgba(255, 255, 0, 0.4);
    }

    .CodeMirror span {
    }

    @media print {
        .CodeMirror div.CodeMirror-cursor {
            visibility: hidden;
        }
    }

    .CodeMirror-lint-markers {
        width: 16px;
    }

    .CodeMirror-lint-tooltip {
        background-color: infobackground;
        border: 1px solid black;
        border-radius: 4px;
        color: infotext;
        font-family: monospace;
        overflow: hidden;
        padding: 2px 5px;
        position: fixed;
        white-space: pre-wrap;
        z-index: 10000;
        max-width: 600px;
        opacity: 0;
        transition: opacity 0.4s;
        font-size: 0.8em;
    }

    .CodeMirror-lint-mark-error, .CodeMirror-lint-mark-warning {
        background-position: left bottom;
        background-repeat: repeat-x;
    }

    .CodeMirror-lint-mark-error {
        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAYAAAC09K7GAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sJDw4cOCW1/KIAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAHElEQVQI12NggIL/DAz/GdA5/xkY/qPKMDAwAADLZwf5rvm+LQAAAABJRU5ErkJggg==");
    }

    .CodeMirror-lint-marker-error, .CodeMirror-lint-marker-warning {
        background-position: center center;
        background-repeat: no-repeat;
        cursor: pointer;
        display: inline-block;
        height: 16px;
        width: 16px;
        vertical-align: middle;
        position: relative;
    }

    .CodeMirror-lint-message-error, .CodeMirror-lint-message-warning {
        padding-left: 18px;
        background-position: left top;
        background-repeat: no-repeat;
    }

    .CodeMirror-lint-marker-error, .CodeMirror-lint-message-error {
        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAHlBMVEW7AAC7AACxAAC7AAC7AAAAAAC4AAC5AAD///+7AAAUdclpAAAABnRSTlMXnORSiwCK0ZKSAAAATUlEQVR42mWPOQ7AQAgDuQLx/z8csYRmPRIFIwRGnosRrpamvkKi0FTIiMASR3hhKW+hAN6/tIWhu9PDWiTGNEkTtIOucA5Oyr9ckPgAWm0GPBog6v4AAAAASUVORK5CYII=");
    }

    .CodeMirror-lint-marker-warning, .CodeMirror-lint-message-warning {
        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAANlBMVEX/uwDvrwD/uwD/uwD/uwD/uwD/uwD/uwD/uwD6twD/uwAAAADurwD2tQD7uAD+ugAAAAD/uwDhmeTRAAAADHRSTlMJ8mN1EYcbmiixgACm7WbuAAAAVklEQVR42n3PUQqAIBBFUU1LLc3u/jdbOJoW1P08DA9Gba8+YWJ6gNJoNYIBzAA2chBth5kLmG9YUoG0NHAUwFXwO9LuBQL1giCQb8gC9Oro2vp5rncCIY8L8uEx5ZkAAAAASUVORK5CYII=");
    }

    .CodeMirror-lint-marker-multiple {
        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAMAAADzjKfhAAAACVBMVEUAAAAAAAC/v7914kyHAAAAAXRSTlMAQObYZgAAACNJREFUeNo1ioEJAAAIwmz/H90iFFSGJgFMe3gaLZ0od+9/AQZ0ADosbYraAAAAAElFTkSuQmCC");
        background-repeat: no-repeat;
        background-position: right bottom;
        width: 100%;
        height: 100%;
    }

    :root {
        --bg-color: #ffffff;
        --text-color: #333333;
        --code-block-bg-color: inherit;
    }

    html {
        font-size: 14px;
        background-color: var(--bg-color);
        color: var(--text-color);
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
        -webkit-font-smoothing: antialiased;
    }

    body {
        margin: 0px;
        padding: 0px;
        height: auto;
        bottom: 0px;
        top: 0px;
        left: 0px;
        right: 0px;
        font-size: 1rem;
        line-height: 1.42857;
        overflow-x: hidden;
        background: inherit;
    }

    a:active, a:hover {
        outline: 0px;
    }

    .in-text-selection, ::selection {
        background: rgb(181, 214, 252);
        text-shadow: none;
    }

    #write {
        margin: 0px auto;
        height: auto;
        width: inherit;
        word-break: normal;
        word-wrap: break-word;
        position: relative;
        padding-bottom: 70px;
        white-space: pre-wrap;
        overflow-x: visible;
    }

    .for-image #write {
        padding-left: 8px;
        padding-right: 8px;
    }

    body.typora-export {
        padding-left: 30px;
        padding-right: 30px;
    }

    @media screen and (max-width: 500px) {
        body.typora-export {
            padding-left: 0px;
            padding-right: 0px;
        }

        .CodeMirror-sizer {
            margin-left: 0px !important;
        }

        .CodeMirror-gutters {
            display: none !important;
        }
    }

    .typora-export #write {
        margin: 0px auto;
    }

    #write > p:first-child, #write > ul:first-child, #write > ol:first-child, #write > pre:first-child, #write > blockquote:first-child, #write > div:first-child, #write > table:first-child {
        margin-top: 30px;
    }

    #write li > table:first-child {
        margin-top: -20px;
    }

    img {
        max-width: 100%;
        vertical-align: middle;
    }

    input, button, select, textarea {
        color: inherit;
        font-style: inherit;
        font-variant: inherit;
        font-weight: inherit;
        font-stretch: inherit;
        font-size: inherit;
        line-height: inherit;
        font-family: inherit;
    }

    input[type="checkbox"], input[type="radio"] {
        line-height: normal;
        padding: 0px;
    }

    ::before, ::after, * {
        box-sizing: border-box;
    }

    #write p, #write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write div, #write pre {
        width: inherit;
    }

    #write p, #write h1, #write h2, #write h3, #write h4, #write h5, #write h6 {
        position: relative;
    }

    h1 {
        font-size: 2rem;
    }

    h2 {
        font-size: 1.8rem;
    }

    h3 {
        font-size: 1.6rem;
    }

    h4 {
        font-size: 1.4rem;
    }

    h5 {
        font-size: 1.2rem;
    }

    h6 {
        font-size: 1rem;
    }

    p {
        -webkit-margin-before: 1rem;
        -webkit-margin-after: 1rem;
        -webkit-margin-start: 0px;
        -webkit-margin-end: 0px;
    }

    .typora-export p {
        white-space: normal;
    }

    .mathjax-block {
        margin-top: 0px;
        margin-bottom: 0px;
        -webkit-margin-before: 0rem;
        -webkit-margin-after: 0rem;
    }

    .hidden {
        display: none;
    }

    .md-blockmeta {
        color: rgb(204, 204, 204);
        font-weight: bold;
        font-style: italic;
    }

    a {
        cursor: pointer;
    }

    sup.md-footnote {
        padding: 2px 4px;
        background-color: rgba(238, 238, 238, 0.7);
        color: rgb(85, 85, 85);
        border-radius: 4px;
    }

    #write input[type="checkbox"] {
        cursor: pointer;
        width: inherit;
        height: inherit;
        margin: 4px 0px 0px;
    }

    tr {
        break-inside: avoid;
        break-after: auto;
    }

    thead {
        display: table-header-group;
    }

    table {
        border-collapse: collapse;
        border-spacing: 0px;
        width: 100%;
        overflow: auto;
        break-inside: auto;
        text-align: left;
    }

    table.md-table td {
        min-width: 80px;
    }

    .CodeMirror-gutters {
        border-right: 0px;
        background-color: inherit;
    }

    .CodeMirror {
        text-align: left;
    }

    .CodeMirror-placeholder {
        opacity: 0.3;
    }

    .CodeMirror pre {
        padding: 0px 4px;
    }

    .CodeMirror-lines {
        padding: 0px;
    }

    div.hr:focus {
        cursor: none;
    }

    pre {
        white-space: pre-wrap;
    }

    .CodeMirror-gutters {
        margin-right: 4px;
    }

    .md-fences {
        font-size: 0.9rem;
        display: block;
        break-inside: avoid;
        text-align: left;
        overflow: visible;
        white-space: pre;
        background: var(--code-block-bg-color);
        position: relative !important;
    }

    .md-diagram-panel {
        width: 100%;
        margin-top: 10px;
        text-align: center;
        padding-top: 0px;
        padding-bottom: 8px;
        overflow-x: auto;
    }

    .md-fences .CodeMirror.CodeMirror-wrap {
        top: -1.6em;
        margin-bottom: -1.6em;
    }

    .md-fences.mock-cm {
        white-space: pre-wrap;
    }

    .show-fences-line-number .md-fences {
        padding-left: 0px;
    }

    .show-fences-line-number .md-fences.mock-cm {
        padding-left: 40px;
    }

    .footnotes {
        opacity: 0.8;
        font-size: 0.9rem;
        padding-top: 1em;
        padding-bottom: 1em;
    }

    .footnotes + .footnotes {
        margin-top: -1em;
    }

    .md-reset {
        margin: 0px;
        padding: 0px;
        border: 0px;
        outline: 0px;
        vertical-align: top;
        background: transparent;
        text-decoration: none;
        text-shadow: none;
        float: none;
        position: static;
        width: auto;
        height: auto;
        white-space: nowrap;
        cursor: inherit;
        -webkit-tap-highlight-color: transparent;
        line-height: normal;
        font-weight: normal;
        text-align: left;
        box-sizing: content-box;
        direction: ltr;
    }

    li div {
        padding-top: 0px;
    }

    blockquote {
        margin: 1rem 0px;
    }

    li p, li .mathjax-block {
        margin: 0.5rem 0px;
    }

    li {
        margin: 0px;
        position: relative;
    }

    blockquote > :last-child {
        margin-bottom: 0px;
    }

    blockquote > :first-child {
        margin-top: 0px;
    }

    .footnotes-area {
        color: rgb(136, 136, 136);
        margin-top: 0.714rem;
        padding-bottom: 0.143rem;
    }

    @media print {
        html, body {
            border: 1px solid transparent;
            height: 99%;
            break-after: avoid;
            break-before: avoid;
        }

        .typora-export * {
            -webkit-print-color-adjust: exact;
        }

        h1, h2, h3, h4, h5, h6 {
            break-after: avoid-page;
            orphans: 2;
        }

        p {
            orphans: 4;
        }

        html.blink-to-pdf {
            font-size: 13px;
        }

        .typora-export #write {
            padding-left: 1cm;
            padding-right: 1cm;
            padding-bottom: 0px;
            break-after: avoid;
        }

        .typora-export #write::after {
            height: 0px;
        }

        @page {
            margin: 20mm 0mm;
        }
    }

    .footnote-line {
        margin-top: 0.714em;
        font-size: 0.7em;
    }

    a img, img a {
        cursor: pointer;
    }

    pre.md-meta-block {
        font-size: 0.8rem;
        min-height: 2.86rem;
        white-space: pre-wrap;
        background: rgb(204, 204, 204);
        display: block;
        overflow-x: hidden;
    }

    p .md-image:only-child {
        display: inline-block;
        width: 100%;
        text-align: center;
    }

    #write .MathJax_Display {
        margin: 0.8em 0px 0px;
    }

    .mathjax-block {
        white-space: pre;
        overflow: hidden;
        width: 100%;
    }

    p + .mathjax-block {
        margin-top: -1.143rem;
    }

    .mathjax-block:not(:empty)::after {
        display: none;
    }

    [contenteditable="true"]:active, [contenteditable="true"]:focus {
        outline: none;
        box-shadow: none;
    }

    .task-list {
        list-style-type: none;
    }

    .task-list-item {
        position: relative;
        padding-left: 1em;
    }

    .task-list-item input {
        position: absolute;
        top: 0px;
        left: 0px;
    }

    .math {
        font-size: 1rem;
    }

    .md-toc {
        min-height: 3.58rem;
        position: relative;
        font-size: 0.9rem;
        border-radius: 10px;
    }

    .md-toc-content {
        position: relative;
        margin-left: 0px;
    }

    .md-toc::after, .md-toc-content::after {
        display: none;
    }

    .md-toc-item {
        display: block;
        color: rgb(65, 131, 196);
        text-decoration: none;
    }

    .md-toc-inner:hover {
    }

    .md-toc-inner {
        display: inline-block;
        cursor: pointer;
    }

    .md-toc-h1 .md-toc-inner {
        margin-left: 0px;
        font-weight: bold;
    }

    .md-toc-h2 .md-toc-inner {
        margin-left: 2em;
    }

    .md-toc-h3 .md-toc-inner {
        margin-left: 4em;
    }

    .md-toc-h4 .md-toc-inner {
        margin-left: 6em;
    }

    .md-toc-h5 .md-toc-inner {
        margin-left: 8em;
    }

    .md-toc-h6 .md-toc-inner {
        margin-left: 10em;
    }

    @media screen and (max-width: 48em) {
        .md-toc-h3 .md-toc-inner {
            margin-left: 3.5em;
        }

        .md-toc-h4 .md-toc-inner {
            margin-left: 5em;
        }

        .md-toc-h5 .md-toc-inner {
            margin-left: 6.5em;
        }

        .md-toc-h6 .md-toc-inner {
            margin-left: 8em;
        }
    }

    a.md-toc-inner {
        font-size: inherit;
        font-style: inherit;
        font-weight: inherit;
        line-height: inherit;
    }

    .footnote-line a:not(.reversefootnote) {
        color: inherit;
    }

    .md-attr {
        display: none;
    }

    .md-fn-count::after {
        content: ".";
    }

    .md-tag {
        opacity: 0.5;
    }

    .md-comment {
        color: rgb(162, 127, 3);
        opacity: 0.8;
        font-family: monospace;
    }

    code {
        text-align: left;
    }

    h1 .md-tag, h2 .md-tag, h3 .md-tag, h4 .md-tag, h5 .md-tag, h6 .md-tag {
        font-weight: initial;
        opacity: 0.35;
    }

    a.md-print-anchor {
        border-width: initial !important;
        border-style: none !important;
        border-color: initial !important;
        display: inline-block !important;
        position: absolute !important;
        width: 1px !important;
        right: 0px !important;
        outline: none !important;
        background: transparent !important;
        text-decoration: initial !important;
        text-shadow: initial !important;
    }

    .md-inline-math .MathJax_SVG .noError {
        display: none !important;
    }

    .mathjax-block .MathJax_SVG_Display {
        text-align: center;
        margin: 1em 0em;
        position: relative;
        text-indent: 0px;
        max-width: none;
        max-height: none;
        min-height: 0px;
        min-width: 100%;
        width: auto;
        display: block !important;
    }

    .MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display {
        width: auto;
        margin: inherit;
        display: inline-block !important;
    }

    .MathJax_SVG .MJX-monospace {
        font-family: monospace;
    }

    .MathJax_SVG .MJX-sans-serif {
        font-family: sans-serif;
    }

    .MathJax_SVG {
        display: inline;
        font-style: normal;
        font-weight: normal;
        line-height: normal;
        zoom: 90%;
        text-indent: 0px;
        text-align: left;
        text-transform: none;
        letter-spacing: normal;
        word-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        float: none;
        direction: ltr;
        max-width: none;
        max-height: none;
        min-width: 0px;
        min-height: 0px;
        border: 0px;
        padding: 0px;
        margin: 0px;
    }

    .MathJax_SVG * {
        transition: none;
    }

    .md-diagram-panel > svg {
        max-width: 100%;
    }

    [lang="flow"] svg, [lang="mermaid"] svg {
        max-width: 100%;
    }

    :root {
        --side-bar-bg-color: #fafafa;
        --control-text-color: #777;
    }

    @font-face {
        font-family: "Open Sans";
        font-style: normal;
        font-weight: normal;
        src: local("Open Sans Regular"), url("./github/400.woff") format("woff");
    }

    @font-face {
        font-family: "Open Sans";
        font-style: italic;
        font-weight: normal;
        src: local("Open Sans Italic"), url("./github/400i.woff") format("woff");
    }

    @font-face {
        font-family: "Open Sans";
        font-style: normal;
        font-weight: bold;
        src: local("Open Sans Bold"), url("./github/700.woff") format("woff");
    }

    @font-face {
        font-family: "Open Sans";
        font-style: italic;
        font-weight: bold;
        src: local("Open Sans Bold Italic"), url("./github/700i.woff") format("woff");
    }

    html {
        font-size: 16px;
    }

    body {
        font-family: "Open Sans", "Clear Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
        color: rgb(51, 51, 51);
        line-height: 1.6;
    }

    #write {
        max-width: 860px;
        margin: 0px auto;
        padding: 20px 30px 100px;
    }

    #write > ul:first-child, #write > ol:first-child {
        margin-top: 30px;
    }

    body > :first-child {
        margin-top: 0px !important;
    }

    body > :last-child {
        margin-bottom: 0px !important;
    }

    a {
        color: rgb(65, 131, 196);
    }

    h1, h2, h3, h4, h5, h6 {
        position: relative;
        margin-top: 1rem;
        margin-bottom: 1rem;
        font-weight: bold;
        line-height: 1.4;
        cursor: text;
    }

    h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
        text-decoration: none;
    }

    h1 tt, h1 code {
        font-size: inherit;
    }

    h2 tt, h2 code {
        font-size: inherit;
    }

    h3 tt, h3 code {
        font-size: inherit;
    }

    h4 tt, h4 code {
        font-size: inherit;
    }

    h5 tt, h5 code {
        font-size: inherit;
    }

    h6 tt, h6 code {
        font-size: inherit;
    }

    h1 {
        padding-bottom: 0.3em;
        font-size: 2.25em;
        line-height: 1.2;
        border-bottom: 1px solid rgb(238, 238, 238);
    }

    h2 {
        padding-bottom: 0.3em;
        font-size: 1.75em;
        line-height: 1.225;
        border-bottom: 1px solid rgb(238, 238, 238);
    }

    h3 {
        font-size: 1.5em;
        line-height: 1.43;
    }

    h4 {
        font-size: 1.25em;
    }

    h5 {
        font-size: 1em;
    }

    h6 {
        font-size: 1em;
        color: rgb(119, 119, 119);
    }

    p, blockquote, ul, ol, dl, table {
        margin: 0.8em 0px;
    }

    li > ol, li > ul {
        margin: 0px;
    }

    hr {
        height: 4px;
        padding: 0px;
        margin: 16px 0px;
        background-color: rgb(231, 231, 231);
        border-width: 0px 0px 1px;
        border-style: none none solid;
        border-top-color: initial;
        border-right-color: initial;
        border-left-color: initial;
        border-image: initial;
        overflow: hidden;
        box-sizing: content-box;
        border-bottom-color: rgb(221, 221, 221);
    }

    body > h2:first-child {
        margin-top: 0px;
        padding-top: 0px;
    }

    body > h1:first-child {
        margin-top: 0px;
        padding-top: 0px;
    }

    body > h1:first-child + h2 {
        margin-top: 0px;
        padding-top: 0px;
    }

    body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
        margin-top: 0px;
        padding-top: 0px;
    }

    a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
        margin-top: 0px;
        padding-top: 0px;
    }

    h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
        margin-top: 0px;
    }

    li p.first {
        display: inline-block;
    }

    ul, ol {
        padding-left: 30px;
    }

    ul:first-child, ol:first-child {
        margin-top: 0px;
    }

    ul:last-child, ol:last-child {
        margin-bottom: 0px;
    }

    blockquote {
        border-left: 4px solid rgb(221, 221, 221);
        padding: 0px 15px;
        color: rgb(119, 119, 119);
    }

    blockquote blockquote {
        padding-right: 0px;
    }

    table {
        padding: 0px;
        word-break: initial;
    }

    table tr {
        border-top: 1px solid rgb(204, 204, 204);
        margin: 0px;
        padding: 0px;
    }

    table tr:nth-child(2n) {
        background-color: rgb(248, 248, 248);
    }

    table tr th {
        font-weight: bold;
        border: 1px solid rgb(204, 204, 204);
        text-align: left;
        margin: 0px;
        padding: 6px 13px;
    }

    table tr td {
        border: 1px solid rgb(204, 204, 204);
        text-align: left;
        margin: 0px;
        padding: 6px 13px;
    }

    table tr th:first-child, table tr td:first-child {
        margin-top: 0px;
    }

    table tr th:last-child, table tr td:last-child {
        margin-bottom: 0px;
    }

    .CodeMirror-gutters {
        border-right: 1px solid rgb(221, 221, 221);
    }

    .md-fences, code, tt {
        border: 1px solid rgb(221, 221, 221);
        background-color: rgb(248, 248, 248);
        border-radius: 3px;
        font-family: Consolas, "Liberation Mono", Courier, monospace;
        padding: 2px 4px 0px;
        font-size: 0.9em;
    }

    .md-fences {
        margin-bottom: 15px;
        margin-top: 15px;
        padding: 8px 1em 6px;
    }

    .task-list {
        padding-left: 0px;
    }

    .task-list-item {
        padding-left: 32px;
    }

    .task-list-item input {
        top: 3px;
        left: 8px;
    }

    @media screen and (min-width: 914px) {
    }

    @media print {
        html {
            font-size: 13px;
        }

        table, pre {
            break-inside: avoid;
        }

        pre {
            word-wrap: break-word;
        }
    }

    .md-fences {
        background-color: rgb(248, 248, 248);
    }

    #write pre.md-meta-block {
        padding: 1rem;
        font-size: 85%;
        line-height: 1.45;
        background-color: rgb(247, 247, 247);
        border: 0px;
        border-radius: 3px;
        color: rgb(119, 119, 119);
        margin-top: 0px !important;
    }

    .mathjax-block > .code-tooltip {
        bottom: 0.375rem;
    }

    #write > h3.md-focus::before {
        left: -1.5625rem;
        top: 0.375rem;
    }

    #write > h4.md-focus::before {
        left: -1.5625rem;
        top: 0.285714rem;
    }

    #write > h5.md-focus::before {
        left: -1.5625rem;
        top: 0.285714rem;
    }

    #write > h6.md-focus::before {
        left: -1.5625rem;
        top: 0.285714rem;
    }

    .md-image > .md-meta {
        border: 1px solid rgb(221, 221, 221);
        border-radius: 3px;
        font-family: Consolas, "Liberation Mono", Courier, monospace;
        padding: 2px 4px 0px;
        font-size: 0.9em;
        color: inherit;
    }

    .md-tag {
        color: inherit;
    }

    .md-toc {
        margin-top: 20px;
        padding-bottom: 20px;
    }

    .sidebar-tabs {
        border-bottom: none;
    }

    #typora-quick-open {
        border: 1px solid rgb(221, 221, 221);
        background-color: rgb(248, 248, 248);
    }

    #typora-quick-open-item {
        background-color: rgb(250, 250, 250);
        border-color: rgb(254, 254, 254) rgb(229, 229, 229) rgb(229, 229, 229) rgb(238, 238, 238);
        border-style: solid;
        border-width: 1px;
    }

    #md-notification::before {
        top: 10px;
    }

    .on-focus-mode blockquote {
        border-left-color: rgba(85, 85, 85, 0.12);
    }

    header, .context-menu, .megamenu-content, footer {
        font-family: "Segoe UI", Arial, sans-serif;
    }

    .file-node-content:hover .file-node-icon, .file-node-content:hover .file-node-open-state {
        visibility: visible;
    }

    .mac-seamless-mode #typora-sidebar {
        background-color: var(--side-bar-bg-color);
    }

    .md-lang {
        color: rgb(180, 101, 77);
    }


    </style>
</head>
<body class='typora-export'>
<div id='write' class='is-node'>
    <b><a name='header-n0' class='md-header-anchor '></a>java 代理设计模式</b>

    <b><a name='header-n1' class='md-header-anchor '></a>1、代理设计模式</b><br>
    <pre class='md-fences mock-cm' style='display:block;position:relative'>
        1.  代理设计模式是Java中针对接口编程的一种应用模式。
        2.  java中代理分为静态代理和动态代理。
        3.  一个接口有很多实现类，其中包括真实主题实现类，和代理主题实现类。真实主题实现类执行真正的核心业务，代理主题实现类负责边缘业务。
        4.  代理设计模式的核心：外部通过操作代理主题，间接的操作真实主题。
        5.  代理设计模式中，代理主题实际上是个代理对象，通过委托真实主题去执行真正的操作，而代理主题本身可以在委托真实主题执行前后执行其他边缘性业务。
        6.  在代理设计模式中，外部直接操作代理主题，真实主题是被代理类委托代理的，即代理类代理了真实主题，代理类委托真实主题处理真正业务。
        7.  代理设计模式本身是对委托机制的一种具体应用场景，它是对委托机制和方法转发的一种模式化应用。
        8.  代理设计模式实现上和装饰者设计模式比较相似，但还是有区别的，区别等学习装饰者模式时再讲。
    </pre>

    <b><a name='header-n2' class='md-header-anchor '></a>2、到底为什么要使用代理模式？</b><br>
    <pre class='md-fences mock-cm' style='display:block;position:relative'>
        1.  有时候，真实主题的某些成员是隐私，不便暴露给客户端，此时可以使用代理主题去代理真实主题，这样，避免了客户端直接操作真实主题。
        2.  有时候，真实主题不具备处理某些附加操作的能力，真实主题不愿因承担过多的边缘性业务能力，真实主题只想处理核心功能，此时可通过代理主题去代理真实主题，这样便可以不用改动真实主题逻辑，而直接在代理主题上强化那些边缘性业务即可。
        3.  有时候，实例化真实主题很慢（比如真实主题去解析大批量文件或者链接数据库等），而真实主题的实例化往往是在系统启动时进行的，这时候就可以使用代理主题，屏蔽掉真实主题耗时的实例化过程，实现真实主题的延迟加载。这样只有在需要调用真实主题的时候再去通过代理主题实例化真实主题并调用真实主题的功能。
        4.  有时候，只想定义一个接口，不想实现它但它的方法仍然可用；或者想为任何一个目标类增加附加功能，就使用动态代理。动态代理比静态代理更灵活。
    </pre>

    <b><a name='header-n3' class='md-header-anchor '></a>3、代理设计模式案例</b><br>
    <pre class='md-fences mock-cm' style='display:block;position:relative'>
        通过案例了解下，不使用代理模式时是什么样子的，使用了代理模式是什么样子的。
        静态代理是什么样子的，动态代理又是什么样子的。

        先准备一个接口，和一个真实主题。真实主题实现对应的接口。

        <b><font color="#a52a2a">IService</font></b>
        package zeh.test.demo.com.daili.service;

        /**
         * 功能描述 业务接口
         *
         * @author zWX5331241
         * @since 2021-03-30
         */
        public interface IService {
            /**
             * 接口方法
             */
            void handleSome();

            /**
             * 接口方法
             */
            void handleOther();
        }


        <b><font color="#a52a2a">PersonService</font></b>
        package zeh.test.demo.com.daili.service;

        /**
         * 功能描述 接口实现类，真实主题
         *
         * @author zWX5331241
         * @since 2021-03-30
         */
        public class PersonService implements IService {
            @Override
            public void handleSome() {
                System.out.println("派出一个人去处理一些业务");
            }

            @Override
            public void handleOther() {
                System.out.println("派出一个人去处理其他事情");
            }
        }
    </pre>
    <b><a name='header-n31' class='md-header-anchor '></a>3.1、 不使用代理模式</b>
    <pre class='md-fences mock-cm' style='display:block;position:relative'>
        <b><font color="#a52a2a">Main</font></b>
        package zeh.test.demo.com.daili.nodaili;

        import zeh.test.demo.com.daili.service.IService;
        import zeh.test.demo.com.daili.service.PersonService;

        /**
         * 功能描述 不使用代理
         *
         * @author zWX5331241
         * @since 2021-03-31
         */
        public class Main {
            public static void main(String[] args) {
                // 不使用任何代理，直接使用真实主题，通过多态进行向上转型
                IService service = new PersonService();

                // 直接通过真实主题对象去实现某些功能
                service.handleSome();
                service.handleOther();
            }
        }

        <b><font color="#a52a2a">测试结果</font></b>
        派出一个人去处理一些业务
        派出一个人去处理其他事情

        Process finished with exit code 0

        <b><font color="#a52a2a">结果分析</font></b>
        不使用代理对象，直接调用真实主题，就是我们普通的面向对象编程的那种套路。
        假如我现在想增强一下service对象的功能，比如，我想让service对象再实现一个“派出一头猪去执行刺杀任务”这个需求，现在该怎么办呢？
        以下是改造方案：

        改造主题接口 IService.java，增加一个方法：
            /**
             * 改动接口，增加方法
             */
            void handleKillTaskByPig();

        再改造对应的真实主题实现，实现接口中增强的那个方法：
            @Override
            public void handleKillTaskByPig() {
                System.out.println("我是一头猪，我现在要去刺杀秦始皇");
            }

        最后开始测试：
        public class Main {
            public static void main(String[] args) {
                // 不使用任何代理，直接使用真实主题，通过多态进行向上转型
                IService service = new PersonService();

                // 直接通过真实主题对象去实现某些功能
                service.handleSome();
                service.handleOther();

                // 改造了主题接口，和其对应的真实主题的实现类，增加了一个方法
                service.handleKillTaskByPig();
            }
        }

        测试结果如下：
        派出一个人去处理一些业务
        派出一个人去处理其他事情
        我是一头猪，我现在要去刺杀秦始皇

        Process finished with exit code 0

        弊端：
        为了增强真实主题的功能，现在改动了主题的接口和实现。
        1.  在开发中，频繁改动顶层接口不太优雅。
        2.  增强的这个方法可能只是 PersonService 这一个实现需要，并不是所有的实现类都需要，直接改动了接口，势必需要所有的实现类都得做出相应的改动。
        3.  如果接口存在很多实现类，则要依次修改所有的实现类。
        4.  退一万步讲，对于真实主题而言，它的核心功能就是 handleSome 和 handleOther ，它本身并不需要做其他功能的增强。
        .....
        等等等等。
        这种情况如何解决呢？
    </pre>
    <b><a name='header-n32' class='md-header-anchor '></a>3.2、 静态代理</b>
    <pre class='md-fences mock-cm' style='display:block;position:relative'>
        使用静态代理。
        1.  通过新增加一个代理类去代理真实主题对象，即委托真实主题去处理核心业务，而代理主题去处理边缘业务，此时代理主题处理的边缘业务对于核心业务而言，就是我们需要增强的功能。
        2.  既然新增的代理主题是为了增强真实主题对象的功能，那么，代理主题暴露给客户端的API应该和真实主题原有的暴露方式是一致的。因此，代理主题需要和真实主题实现同一个接口，并且覆盖主题接口中的业务方法从而对外暴露业务。
        3.  代理主题类实现主题接口，需要实现主题接口中的所有方法。需要代理哪些方法就对哪些方法委托真实主题去处理并加入代理逻辑，可以根据诉求代理一个方法或者代理多个方法。

        <b><font color="#a52a2a">新增代理主题实现类 StaticProxy</font></b>
        package zeh.test.demo.com.daili.statics;

        import zeh.test.demo.com.daili.service.IService;

        /**
         * 功能描述 代理主题。
         * 和真实主题实现相同的业务接口，目的是为了暴露给客户端使用完全相同的API。即代理主题和真实主题暴露给客户端的使用方式应该不被客户端感知。
         *
         * @author zWX5331241
         * @since 2021-03-30
         */
        public class StaticProxy implements IService {
            private IService iService;

            public StaticProxy(IService iService) {
                this.iService = iService;
            }

            @Override
            public void handleSome() {
                System.out.println("静态代理 begin");
                iService.handleSome();
                System.out.println("静态代理 end");
            }

            @Override
            public void handleOther() {
                System.out.println("静态代理 begin");
                iService.handleOther();
                System.out.println("静态代理 end");
            }
        }


        <b><font color="#a52a2a">测试静态代理 StaticProxyMain</font></b>
        package zeh.test.demo.com.daili.statics;

        import zeh.test.demo.com.daili.service.IService;
        import zeh.test.demo.com.daili.service.PersonService;

        /**
         * 功能描述 测试静态代理
         *
         * @author zWX5331241
         * @since 2021-03-30
         */
        public class StaticProxyMain {
            public static void main(String[] args) {
                // 控制程序先向代理主题注入真实主题对象，然后直接调用代理主题的方法，当执行代理主题的方法时，线程被转发到真实主题的方法。
                IService service = new PersonService();
                StaticProxy proxy = new StaticProxy(service);
                proxy.handleSome();
                proxy.handleOther();
            }
        }

        <b><font color="#a52a2a">测试结果</font></b>
        静态代理 begin
        派出一个人去处理一些业务
        静态代理 end
        静态代理 begin
        派出一个人去处理其他事情
        静态代理 end

        Process finished with exit code 0

        <b><font color="#a52a2a">结果分析</font></b>
        通过静态代理模式，增强了真实主题的功能：
        1.  没有改动业务接口。
        2.  没有改动实现类。
        3.  真实主题实际上没有发生任何改动，只是在它上层加了一层代理类。
        4.  真实主题不直接暴露给客户端，直接暴露给客户端的是代理主题。
    </pre>
    <b><a name='header-n33' class='md-header-anchor '></a>3.3、 静态代理的缺陷</b>
    <pre class='md-fences mock-cm' style='display:block;position:relative'>
        <b><font color="#a52a2a">新增一个主题接口 IKill</font></b>
        package zeh.test.demo.com.daili.service;

        /**
         * 功能描述
         *
         * @author zWX5331241
         * @since 2021-03-31
         */
        public interface IKill {

            void killPeople();
        }

        <b><font color="#a52a2a">新增一个真实主题实现类 PersonKill</font></b>
        package zeh.test.demo.com.daili.service;

        /**
         * 功能描述
         *
         * @author zWX5331241
         * @since 2021-03-31
         */
        public class PersonKill implements IKill {
            @Override
            public void killPeople() {
                System.out.println("我去杀人啦");
            }
        }

        <b><font color="#a52a2a">要想代理IKill接口，则必须新增一个代理主题实现类 StaticProxyForKill</font></b>
        package zeh.test.demo.com.daili.statics;

        import zeh.test.demo.com.daili.service.IKill;

        /**
         * 功能描述
         *
         * @author zWX5331241
         * @since 2021-03-31
         */
        public class StaticProxyForKill implements IKill {
            private IKill kill;

            public StaticProxyForKill(IKill kill) {
                this.kill = kill;
            }

            @Override
            public void killPeople() {
                System.out.println("增强逻辑：你杀人你想过后果吗？");
                kill.killPeople();
                System.out.println("增强逻辑：你杀人了，等着抵命吧！");
            }
        }

        <b><font color="#a52a2a">测试</font></b>
        package zeh.test.demo.com.daili.statics;

        import zeh.test.demo.com.daili.service.IKill;
        import zeh.test.demo.com.daili.service.IService;
        import zeh.test.demo.com.daili.service.PersonKill;
        import zeh.test.demo.com.daili.service.PersonService;

        /**
         * 功能描述 测试静态代理
         *
         * @author zWX5331241
         * @since 2021-03-30
         */
        public class StaticProxyMain {
            public static void main(String[] args) {
                // 控制程序先向代理主题注入真实主题对象，然后直接调用代理主题的方法，当执行代理主题的方法时，线程转发到真实主题的方法。
                IService service = new PersonService();
                StaticProxy proxy = new StaticProxy(service);
                proxy.handleSome();
                proxy.handleOther();

                IKill kill = new PersonKill();
                StaticProxyForKill proxyForKill = new StaticProxyForKill(kill);
                proxyForKill.killPeople();
            }
        }

        <b><font color="#a52a2a">测试结果</font></b>
        静态代理 begin
        派出一个人去处理一些业务
        静态代理 end
        静态代理 begin
        派出一个人去处理其他事情
        静态代理 end
        增强逻辑：你杀人你想过后果吗？
        我去杀人啦
        你杀人了，等着抵命吧！

        Process finished with exit code 0

        <b><font color="#a52a2a">结果分析</font></b>

    </pre>

    <b><a name='header-n4' class='md-header-anchor '></a>4、死磕动态代理</b><br>
    <pre class='md-fences mock-cm' style='display:block;position:relative'>
        既然静态代理存在那么多弊端，我们设想下：
        如果我们不用去编写代理主题类，而是能有个什么东西默认为我们去生成对应业务的代理主题类、自动的注入对应的真实主题对象、覆盖主题接口中的所有业务方法、并且在我们访问该代理对象的业务方法时能够自动的转发到真实主题对应的方法上，那该有多好啊！
        说白了，就是我想找一个大神来帮我做静态代理这一堆事，而不是我自己去挨个编写代码！
        很幸运，jdk就提供了这种能力：jdk的动态字节码机制可以为任何接口去生成一个存在于JVM内存中的虚拟实现类，有了这种能力，我们就可以实现上述设想了。
    </pre>
    <pre class='md-fences mock-cm' style='display:block;position:relative'>
        使用动态代理，一般只需要一个动态代理主题类用来产生动态代理对象即可。
        不论存在多少种类的业务接口，不论业务接口存在多少方法，都可以通过一个动态代理主题类就可以实现通用的代理方案。
        准备的主题接口和真实主题如下。

        <b><font color="#a52a2a">IKill</font></b>
        package zeh.test.demo.com.daili.service;

        /**
         * 功能描述
         *
         * @author zWX5331241
         * @since 2021-03-31
         */
        public interface IKill {

            void killPeople();

            void killTrump();
        }

        <b><font color="#a52a2a">IService</font></b>
        package zeh.test.demo.com.daili.service;

        /**
         * 功能描述 业务接口
         *
         * @author zWX5331241
         * @since 2021-03-30
         */
        public interface IService {

            void handleSome();

            void handleOther();

            void handleEat();

            void handleDrink();
        }

        <b><font color="#a52a2a">PersonKill</font></b>
        package zeh.test.demo.com.daili.service;

        /**
         * 功能描述
         *
         * @author zWX5331241
         * @since 2021-03-31
         */
        public class PersonKill implements IKill {
            @Override
            public void killPeople() {
                System.out.println("我去杀人啦");
            }

            @Override
            public void killTrump() {
                System.out.println("杀了川普");
            }
        }

        <b><font color="#a52a2a">PersonService</font></b>
        package zeh.test.demo.com.daili.service;

        /**
         * 功能描述 接口实现类，真实主题
         *
         * @author zWX5331241
         * @since 2021-03-30
         */
        public class PersonService implements IService {
            @Override
            public void handleSome() {
                System.out.println("派出一个人去处理一些业务");
            }

            @Override
            public void handleOther() {
                System.out.println("派出一个人去处理其他事情");
            }

            @Override
            public void handleEat() {
                System.out.println("派出一个人去吃饭");
            }

            @Override
            public void handleDrink() {
                System.out.println("派出一个人去喝水");
            }
        }

    </pre>
    <b><a name='header-n41' class='md-header-anchor '></a>4.1、 动态代理</b>
    <pre class='md-fences mock-cm' style='display:block;position:relative'>

        <b><font color="#a52a2a">动态代理工厂 DynamicProxy</font></b>
        package zeh.test.demo.com.daili.dynamic;

        import java.lang.reflect.InvocationHandler;
        import java.lang.reflect.Method;
        import java.lang.reflect.Proxy;

        /**
         * 功能描述 动态代理主题类，不用实现业务接口，实际上是个动态代理工厂，负责根据传入的参数动态生成代理对象
         *
         * @author zWX5331241
         * @since 2021-03-30
         */
        public class DynamicProxy {

            // 委托一个真实主题对象，该对象通过Object接收，可以接受任何类型
            private Object target;

            public DynamicProxy(Object target) {
                this.target = target;
            }

            /**
             * 动态生成代理对象，实际上是动态生成代理对象对应的字节码文件，然后根据字节码文件创建的代理对象。
             * InvocationHandler实际上是一个回调接口，其中的 invoke 方法实际上是一个通用的回调方法。
             *
             * @return
             */
            public Object getProxyInstance() {
                // Proxy.newProxyInstance方法根据传入的真实主题对象的class和对应的接口，生成对应的代理对象。
                Object proxy = Proxy.newProxyInstance(target.getClass().getClassLoader(), target.getClass().getInterfaces(), new InvocationHandler() {
                    @Override
                    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
                        System.out.println("动态代理 begin");
                        Object returnValue = method.invoke(target, args);
                        System.out.println("动态代理 end");
                        return returnValue;
                    }
                });
                return proxy;
            }
        }

        <b><font color="#a52a2a">测试动态代理 DynamicProxyMain</font></b>
        package zeh.test.demo.com.daili.dynamic;

        import zeh.test.demo.com.daili.service.IKill;
        import zeh.test.demo.com.daili.service.IService;
        import zeh.test.demo.com.daili.service.PersonKill;
        import zeh.test.demo.com.daili.service.PersonService;

        /**
         * 功能描述
         *
         * @author zWX5331241
         * @since 2021-03-30
         */
        public class DynamicProxyMain {
            public static void main(String[] args) {
                IService iService = new PersonService();
                IKill iKill = new PersonKill();
                System.out.println("真实主题类型：" + iService.getClass());
                System.out.println("真实主题类型：" + iKill.getClass());

                IService serviceProxy = (IService) new DynamicProxy(iService).getProxyInstance();
                IKill killProxy = (IKill) new DynamicProxy(iKill).getProxyInstance();
                System.out.println("内存中存在的代理对象类型：" + serviceProxy.getClass());
                System.out.println("内存中存在的代理对象类型：" + killProxy.getClass());

                // 执行代理方法
                serviceProxy.handleSome();
                serviceProxy.handleOther();
                serviceProxy.handleDrink();
                serviceProxy.handleEat();

                killProxy.killPeople();
                killProxy.killTrump();
            }
        }

        <b><font color="#a52a2a">测试结果</font></b>
        真实主题类型：class zeh.test.demo.com.daili.service.PersonService
        真实主题类型：class zeh.test.demo.com.daili.service.PersonKill
        内存中存在的代理对象类型：class com.sun.proxy.$Proxy0
        内存中存在的代理对象类型：class com.sun.proxy.$Proxy1
        动态代理 begin
        派出一个人去处理一些业务
        动态代理 end
        动态代理 begin
        派出一个人去处理其他事情
        动态代理 end
        动态代理 begin
        派出一个人去喝水
        动态代理 end
        动态代理 begin
        派出一个人去吃饭
        动态代理 end
        动态代理 begin
        我去杀人啦
        动态代理 end
        动态代理 begin
        杀了川普
        动态代理 end

        Process finished with exit code 0

        <b><font color="#a52a2a">结果分析</font></b>
        1.  动态代理只需要实现一个动态代理工厂类，用于产生动态代理对象即可。
        2.  动态代理工厂可以根据传入的类型，为指定类型的接口生成指定的代理对象。
        3.  动态代理对象可以代理任何指定类型的真实主题。
        4.  动态代理要求真实主题类至少应该实现一个接口，但不要求代理主题工厂类实现接口。

        <b><font color="#a52a2a">遗留问题？</font></b>
        JDK提供的动态代理，只能代理接口吗？
        换言之，只能为接口生成动态字节码的实现类吗？
        如果需要代理一个普通类，该怎么办呢？

        解答：
        JDK提供的动态代理，只能代理接口。因为动态代理底层生成的代理类的字节码，已经继承了Proxy类，因此，这个动态字节码就不能再继承其他类了。所以，它只能代理接口。
        如果需要代理普通类，请使用第三方的cglib。
    </pre>
    <b><a name='header-n42' class='md-header-anchor '></a>4.2、 jdk动态代理总结</b>
    <pre class='md-fences mock-cm' style='display:block;position:relative'>
        1.  jdk动态代理可以实现通用代理，即可以代理任何目标接口的实现类。
        2.  jdk动态代理的原理是底层提供的动态字节码技术，即jdk可以为任何接口都动态产生一个虚拟的实现子类，该子类字节码随着JVM启动存储在内存中，JVM销毁则销毁。
        3.  jdk动态代理只能代理接口，而不能代理普通类，因此，它要求被代理的真实主题类必须至少实现一个接口，否则将无法为其生成代理子类。
    </pre>

</div>
</body>
</html>

